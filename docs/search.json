[
  {
    "objectID": "aula1.html",
    "href": "aula1.html",
    "title": "Aula 1 - Introdução ao R e AUDPC",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nIntrodução ao ambiente de análise R\nCriação e organização de projetos\nInstalação e carregamento de pacotes\nExecução de comandos básicos\nIntrodução ao modelo de documento ‘Quarto’\nVisualização gráfica com ggplot2\nCálculo e interpretação da AUDPC (Área abaixo da curva de progresso da doença)\n\n\n# ───────────────────────────────────────────────────────────────\n# Instalação e carregamento de pacotes\n\n# O pacote agricolae contém funções úteis para experimentação agrícola,\n# como o cálculo da AUDPC (área abaixo da curva de progresso da doença).\nlibrary(agricolae)\n\n# tidyverse é uma coleção de pacotes para manipulação e visualização de dados.\nlibrary(tidyverse)\n\n\n# ───────────────────────────────────────────────────────────────\n# Exemplo básico de uso da função audpc()\n\n# Vetor com as datas das avaliações da doença (em dias após o plantio)\ndates &lt;- c(14, 21, 28)  \ndates\n\n[1] 14 21 28\n\n# Severidade da doença em cada data correspondente\nseverity &lt;- c(40, 80, 90)  \nseverity\n\n[1] 40 80 90\n\n# Cálculo da AUDPC com base nos valores de severidade e datas\naudpc(severity, dates, type = \"absolute\")\n\nevaluation \n      1015 \n\n# type = \"absolute\" calcula a área total sob a curva (sem normalizar)\n\n\n# ───────────────────────────────────────────────────────────────\n# Explorando conjunto de dados de exemplo (incluso no pacote agricolae)\ndata(corn)  # dataset com dados simulados de milho\nstr(corn)   # estrutura do objeto 'corn'\n\n'data.frame':   34 obs. of  3 variables:\n $ method     : int  1 1 1 1 1 1 1 1 1 2 ...\n $ observation: int  83 91 94 89 89 96 91 92 90 91 ...\n $ rx         : num  11 23 28.5 17 17 31.5 23 26 19.5 23 ...\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Criando um gráfico de progresso da doença\n\n# Definindo datas e severidade de uma curva simulada\ndates &lt;- c(7, 14, 21, 28, 35, 42)\nseverity &lt;- c(0.1, 5, 10, 35, 50, 60)\n\n# Criando um data frame com as datas e severidade\ndata_curva &lt;- data.frame(dates, severity)\n\n# Usando o operador |&gt; (pipe) para aplicar funções de forma sequencial\n# Criamos uma nova coluna chamada 'severity2' com dados ajustados para visualização\n\ndata_curva |&gt;  \n  mutate(severity2 = c(1, 10, 35, 58, 70, 79)) |&gt; \n  ggplot(aes(dates, severity2)) +  # Mapeamento estético: eixo x = datas, eixo y = severidade2\n  geom_area(fill = \"blue\") +       # Área sob a curva (cor azul)\n  geom_line(linewidth = 2, color = \"red\") +  # Linha vermelha grossa\n  geom_point(size = 4, color = \"yellow\") +   # Pontos de avaliação (amarelos)\n  labs(x = \"Dias após o plantio\", y = \"Severidade\") +  # Rótulos dos eixos\n  scale_y_continuous(limits = c(0, 100))     # Limite do eixo y de 0 a 100"
  },
  {
    "objectID": "aula1.html#aula-1-19032025",
    "href": "aula1.html#aula-1-19032025",
    "title": "Aula 1 - Introdução ao R e AUDPC",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nIntrodução ao ambiente de análise R\nCriação e organização de projetos\nInstalação e carregamento de pacotes\nExecução de comandos básicos\nIntrodução ao modelo de documento ‘Quarto’\nVisualização gráfica com ggplot2\nCálculo e interpretação da AUDPC (Área abaixo da curva de progresso da doença)\n\n\n# ───────────────────────────────────────────────────────────────\n# Instalação e carregamento de pacotes\n\n# O pacote agricolae contém funções úteis para experimentação agrícola,\n# como o cálculo da AUDPC (área abaixo da curva de progresso da doença).\nlibrary(agricolae)\n\n# tidyverse é uma coleção de pacotes para manipulação e visualização de dados.\nlibrary(tidyverse)\n\n\n# ───────────────────────────────────────────────────────────────\n# Exemplo básico de uso da função audpc()\n\n# Vetor com as datas das avaliações da doença (em dias após o plantio)\ndates &lt;- c(14, 21, 28)  \ndates\n\n[1] 14 21 28\n\n# Severidade da doença em cada data correspondente\nseverity &lt;- c(40, 80, 90)  \nseverity\n\n[1] 40 80 90\n\n# Cálculo da AUDPC com base nos valores de severidade e datas\naudpc(severity, dates, type = \"absolute\")\n\nevaluation \n      1015 \n\n# type = \"absolute\" calcula a área total sob a curva (sem normalizar)\n\n\n# ───────────────────────────────────────────────────────────────\n# Explorando conjunto de dados de exemplo (incluso no pacote agricolae)\ndata(corn)  # dataset com dados simulados de milho\nstr(corn)   # estrutura do objeto 'corn'\n\n'data.frame':   34 obs. of  3 variables:\n $ method     : int  1 1 1 1 1 1 1 1 1 2 ...\n $ observation: int  83 91 94 89 89 96 91 92 90 91 ...\n $ rx         : num  11 23 28.5 17 17 31.5 23 26 19.5 23 ...\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Criando um gráfico de progresso da doença\n\n# Definindo datas e severidade de uma curva simulada\ndates &lt;- c(7, 14, 21, 28, 35, 42)\nseverity &lt;- c(0.1, 5, 10, 35, 50, 60)\n\n# Criando um data frame com as datas e severidade\ndata_curva &lt;- data.frame(dates, severity)\n\n# Usando o operador |&gt; (pipe) para aplicar funções de forma sequencial\n# Criamos uma nova coluna chamada 'severity2' com dados ajustados para visualização\n\ndata_curva |&gt;  \n  mutate(severity2 = c(1, 10, 35, 58, 70, 79)) |&gt; \n  ggplot(aes(dates, severity2)) +  # Mapeamento estético: eixo x = datas, eixo y = severidade2\n  geom_area(fill = \"blue\") +       # Área sob a curva (cor azul)\n  geom_line(linewidth = 2, color = \"red\") +  # Linha vermelha grossa\n  geom_point(size = 4, color = \"yellow\") +   # Pontos de avaliação (amarelos)\n  labs(x = \"Dias após o plantio\", y = \"Severidade\") +  # Rótulos dos eixos\n  scale_y_continuous(limits = c(0, 100))     # Limite do eixo y de 0 a 100"
  },
  {
    "objectID": "aula1.html#observações-finais",
    "href": "aula1.html#observações-finais",
    "title": "Aula 1 - Introdução ao R e AUDPC",
    "section": "Observações finais",
    "text": "Observações finais\n\nA função audpc() é amplamente usada para quantificar a severidade acumulada de doenças ao longo do tempo.\nA visualização com ggplot2 permite interpretar graficamente o progresso da doença.\nO uso do Quarto permite consolidar análises, gráficos e interpretações em documentos científicos reprodutíveis."
  },
  {
    "objectID": "aula6.html",
    "href": "aula6.html",
    "title": "Aula 6 - Transformações, Modelos Mistos e Regressões Não Lineares",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar transformações Box-Cox em dados não normais\nAjustar modelos lineares por experimento\nUsar modelos mistos com estrutura hierárquica\nVisualizar interações entre tratamentos e experimentos\nAjustar modelos de regressão não linear (dose-resposta)\n\n\n# ───────────────────────────────────────────────────────────────\n# Transformação Box-Cox em dados de contagem\n\nlibrary(MASS)\nlibrary(DHARMa)\nlibrary(epifitter)\nlibrary(tidyverse)\n\ninsects &lt;- InsectSprays\n\n# Ajuste inicial e avaliação dos resíduos\nm1 &lt;- lm(count ~ spray, data = insects)\nplot(simulateResiduals(m1))\n\n\n\n\n\n\n\n# Box-Cox para determinar transformação ideal\nb &lt;- boxcox(count + 0.1 ~ 1, data = insects)\n\n\n\n\n\n\n\nlambda &lt;- b$x[which.max(b$y)]\nlambda\n\n[1] 0.4242424\n\n# Aplicando transformação e inspecionando\ninsects &lt;- insects |&gt; \n  mutate(count2 = (count^lambda - 1) / lambda,\n         count3 = sqrt(count))\n\nhist(insects$count2)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Regressões por experimento (modelo separado por exp)\n\nlibrary(gsheet)\nlibrary(ggplot2)\n\nestande &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555\")\n\nestande |&gt; \n  ggplot(aes(trat, nplants)) +\n  geom_point(width = 0.1) +\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"darkgreen\") +\n  facet_wrap(~exp) +\n  theme_minimal() +\n  labs(x = \"Tratamento\", y = \"Número de plantas\")\n\n\n\n\n\n\n\n# Modelos separados por experimento\nexp1 &lt;- estande |&gt; filter(exp == 1)\nm_exp1 &lt;- lm(nplants ~ trat, data = exp1)\nsummary(m_exp1)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,   Adjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n\nexp2 &lt;- estande |&gt; filter(exp == 2)\nm_exp2 &lt;- lm(nplants ~ trat + bloco, data = exp2)\nsummary(m_exp2)\n\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-20.4399  -7.7581  -0.0514   6.5960  26.0393 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  49.2774     6.4366   7.656 1.65e-07 ***\ntrat         -0.7007     0.1489  -4.705 0.000121 ***\nbloco         4.6833     2.1939   2.135 0.044734 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.02 on 21 degrees of freedom\nMultiple R-squared:  0.5597,    Adjusted R-squared:  0.5177 \nF-statistic: 13.35 on 2 and 21 DF,  p-value: 0.0001818\n\nexp3 &lt;- estande |&gt; filter(exp == 3)\nm_exp3 &lt;- lm(nplants ~ trat + bloco, data = exp3)\nsummary(m_exp3)\n\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7887  -3.8263   0.9285   5.0952  19.6285 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  97.0833     5.7654  16.839 1.13e-13 ***\ntrat         -0.7634     0.1334  -5.723 1.11e-05 ***\nbloco        -0.5333     1.9652  -0.271    0.789    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.76 on 21 degrees of freedom\nMultiple R-squared:  0.6098,    Adjusted R-squared:  0.5727 \nF-statistic: 16.41 on 2 and 21 DF,  p-value: 5.106e-05\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo misto considerando exp e blocos como efeitos aleatórios\n\nlibrary(lme4)\n\nm_misto &lt;- lmer(nplants ~ trat + (1 | exp/bloco), data = estande)\nconfint(m_misto)\n\n                 2.5 %     97.5 %\n.sig01       3.3332097 14.4218422\n.sig02       7.2377419 47.8269818\n.sigma       9.7314178 13.9359486\n(Intercept) 43.4631239 96.0274587\ntrat        -0.7328972 -0.4044812\n\nsummary(m_misto)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (1 | exp/bloco)\n   Data: estande\n\nREML criterion at convergence: 575.8\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.21697 -0.63351  0.04292  0.67094  1.92907 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n bloco:exp (Intercept)  54.76    7.40   \n exp       (Intercept) 377.43   19.43   \n Residual              134.99   11.62   \nNumber of obs: 72, groups:  bloco:exp, 12; exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 69.74524   11.57191   6.027\ntrat        -0.56869    0.08314  -6.840\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.111\n\ncar::Anova(m_misto)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: nplants\n      Chisq Df Pr(&gt;Chisq)    \ntrat 46.788  1  7.909e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Visualização das interações experimento x tratamento\n\nestande |&gt; \n  ggplot(aes(trat, nplants, colour = factor(exp))) +\n  geom_point() +\n  geom_abline(intercept = 69.74, slope = -0.568, linewidth = 2) +\n  geom_abline(intercept = 43, slope = -0.73, linetype = \"dashed\") +\n  geom_abline(intercept = 96, slope = -0.40, linetype = \"dashed\")\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Regressão não linear – modelo de dose-resposta\n\nfungi &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nfungi |&gt; \n  group_by(code, dose) |&gt; \n  summarise(germination = mean(germination), .groups = \"drop\") |&gt; \n  ggplot(aes(dose, germination)) +\n  geom_point(width = 0.1) +\n  geom_line() +\n  facet_wrap(~code)\n\n\n\n\n\n\n\n# Modelo para um isolado específico\nFGT43 &lt;- fungi |&gt; \n  group_by(code, dose) |&gt; \n  summarise(germination = mean(germination), .groups = \"drop\") |&gt; \n  filter(code == \"FGT43\")\n\nlibrary(drc)\nm43 &lt;- drm(germination ~ dose, data = FGT43, fct = LL.3())\nAIC(m43)\n\n[1] 26.7762\n\nplot(m43)\n\n\n\n\n\n\n\nED(m43, 50)\n\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50 0.495895   0.060851\n\n# Estimativa de EC50 para todos os isolados\nlibrary(ec50estimator)\ndf_ec50 = estimate_EC50(germination ~ dose, \n                        data = fungi, \n                        isolate_col = \"code\", \n                        strata_col =  \"state\", \n                        interval = \"delta\", \n                        fct = drc::LL.3())\n\n# Visualização dos EC50 por isolado\n\ndf_ec50 |&gt; \n  ggplot(aes(reorder(ID, Estimate), Estimate)) +\n  geom_point() +\n  coord_flip()\n\n\n\n\n\n\n\ndf_ec50 |&gt; \n  ggplot(aes(x = Estimate)) +\n  geom_boxplot() +\n  geom_histogram(bins = 5, color = \"white\")"
  },
  {
    "objectID": "aula6.html#aula-6-14052025",
    "href": "aula6.html#aula-6-14052025",
    "title": "Aula 6 - Transformações, Modelos Mistos e Regressões Não Lineares",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar transformações Box-Cox em dados não normais\nAjustar modelos lineares por experimento\nUsar modelos mistos com estrutura hierárquica\nVisualizar interações entre tratamentos e experimentos\nAjustar modelos de regressão não linear (dose-resposta)\n\n\n# ───────────────────────────────────────────────────────────────\n# Transformação Box-Cox em dados de contagem\n\nlibrary(MASS)\nlibrary(DHARMa)\nlibrary(epifitter)\nlibrary(tidyverse)\n\ninsects &lt;- InsectSprays\n\n# Ajuste inicial e avaliação dos resíduos\nm1 &lt;- lm(count ~ spray, data = insects)\nplot(simulateResiduals(m1))\n\n\n\n\n\n\n\n# Box-Cox para determinar transformação ideal\nb &lt;- boxcox(count + 0.1 ~ 1, data = insects)\n\n\n\n\n\n\n\nlambda &lt;- b$x[which.max(b$y)]\nlambda\n\n[1] 0.4242424\n\n# Aplicando transformação e inspecionando\ninsects &lt;- insects |&gt; \n  mutate(count2 = (count^lambda - 1) / lambda,\n         count3 = sqrt(count))\n\nhist(insects$count2)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Regressões por experimento (modelo separado por exp)\n\nlibrary(gsheet)\nlibrary(ggplot2)\n\nestande &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555\")\n\nestande |&gt; \n  ggplot(aes(trat, nplants)) +\n  geom_point(width = 0.1) +\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"darkgreen\") +\n  facet_wrap(~exp) +\n  theme_minimal() +\n  labs(x = \"Tratamento\", y = \"Número de plantas\")\n\n\n\n\n\n\n\n# Modelos separados por experimento\nexp1 &lt;- estande |&gt; filter(exp == 1)\nm_exp1 &lt;- lm(nplants ~ trat, data = exp1)\nsummary(m_exp1)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,   Adjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n\nexp2 &lt;- estande |&gt; filter(exp == 2)\nm_exp2 &lt;- lm(nplants ~ trat + bloco, data = exp2)\nsummary(m_exp2)\n\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-20.4399  -7.7581  -0.0514   6.5960  26.0393 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  49.2774     6.4366   7.656 1.65e-07 ***\ntrat         -0.7007     0.1489  -4.705 0.000121 ***\nbloco         4.6833     2.1939   2.135 0.044734 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.02 on 21 degrees of freedom\nMultiple R-squared:  0.5597,    Adjusted R-squared:  0.5177 \nF-statistic: 13.35 on 2 and 21 DF,  p-value: 0.0001818\n\nexp3 &lt;- estande |&gt; filter(exp == 3)\nm_exp3 &lt;- lm(nplants ~ trat + bloco, data = exp3)\nsummary(m_exp3)\n\n\nCall:\nlm(formula = nplants ~ trat + bloco, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7887  -3.8263   0.9285   5.0952  19.6285 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  97.0833     5.7654  16.839 1.13e-13 ***\ntrat         -0.7634     0.1334  -5.723 1.11e-05 ***\nbloco        -0.5333     1.9652  -0.271    0.789    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.76 on 21 degrees of freedom\nMultiple R-squared:  0.6098,    Adjusted R-squared:  0.5727 \nF-statistic: 16.41 on 2 and 21 DF,  p-value: 5.106e-05\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo misto considerando exp e blocos como efeitos aleatórios\n\nlibrary(lme4)\n\nm_misto &lt;- lmer(nplants ~ trat + (1 | exp/bloco), data = estande)\nconfint(m_misto)\n\n                 2.5 %     97.5 %\n.sig01       3.3332097 14.4218422\n.sig02       7.2377419 47.8269818\n.sigma       9.7314178 13.9359486\n(Intercept) 43.4631239 96.0274587\ntrat        -0.7328972 -0.4044812\n\nsummary(m_misto)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (1 | exp/bloco)\n   Data: estande\n\nREML criterion at convergence: 575.8\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.21697 -0.63351  0.04292  0.67094  1.92907 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n bloco:exp (Intercept)  54.76    7.40   \n exp       (Intercept) 377.43   19.43   \n Residual              134.99   11.62   \nNumber of obs: 72, groups:  bloco:exp, 12; exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 69.74524   11.57191   6.027\ntrat        -0.56869    0.08314  -6.840\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.111\n\ncar::Anova(m_misto)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: nplants\n      Chisq Df Pr(&gt;Chisq)    \ntrat 46.788  1  7.909e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Visualização das interações experimento x tratamento\n\nestande |&gt; \n  ggplot(aes(trat, nplants, colour = factor(exp))) +\n  geom_point() +\n  geom_abline(intercept = 69.74, slope = -0.568, linewidth = 2) +\n  geom_abline(intercept = 43, slope = -0.73, linetype = \"dashed\") +\n  geom_abline(intercept = 96, slope = -0.40, linetype = \"dashed\")\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Regressão não linear – modelo de dose-resposta\n\nfungi &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652\")\n\nfungi |&gt; \n  group_by(code, dose) |&gt; \n  summarise(germination = mean(germination), .groups = \"drop\") |&gt; \n  ggplot(aes(dose, germination)) +\n  geom_point(width = 0.1) +\n  geom_line() +\n  facet_wrap(~code)\n\n\n\n\n\n\n\n# Modelo para um isolado específico\nFGT43 &lt;- fungi |&gt; \n  group_by(code, dose) |&gt; \n  summarise(germination = mean(germination), .groups = \"drop\") |&gt; \n  filter(code == \"FGT43\")\n\nlibrary(drc)\nm43 &lt;- drm(germination ~ dose, data = FGT43, fct = LL.3())\nAIC(m43)\n\n[1] 26.7762\n\nplot(m43)\n\n\n\n\n\n\n\nED(m43, 50)\n\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50 0.495895   0.060851\n\n# Estimativa de EC50 para todos os isolados\nlibrary(ec50estimator)\ndf_ec50 = estimate_EC50(germination ~ dose, \n                        data = fungi, \n                        isolate_col = \"code\", \n                        strata_col =  \"state\", \n                        interval = \"delta\", \n                        fct = drc::LL.3())\n\n# Visualização dos EC50 por isolado\n\ndf_ec50 |&gt; \n  ggplot(aes(reorder(ID, Estimate), Estimate)) +\n  geom_point() +\n  coord_flip()\n\n\n\n\n\n\n\ndf_ec50 |&gt; \n  ggplot(aes(x = Estimate)) +\n  geom_boxplot() +\n  geom_histogram(bins = 5, color = \"white\")"
  },
  {
    "objectID": "aula4.html",
    "href": "aula4.html",
    "title": "Aula 4 - Modelos Lineares Generalizados e Interações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAvaliar modelos com resíduos simulados (pacote DHARMa)\nIntroduzir modelos lineares generalizados (GLMs)\nAvaliar interações entre fatores com ANOVA e emmeans\nUsar transformações, identificar efeitos principais e interações\nGerar gráficos de interação e comparação de médias\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(DHARMa)\nlibrary(car)\nlibrary(multcomp)\nlibrary(emmeans)\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(agricolae)\nlibrary(epifitter)\n\n\n# ───────────────────────────────────────────────────────────────\ninsetos &lt;- InsectSprays\nm3 &lt;- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n\n\n\n\n\n\n\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n\n\n\n\n\n\n\nshapiro.test(residuals(m3))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n\nanova(m3)\n\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Avaliação de resíduos do modelo anterior (paramétrico)\n\nm3\n\n\nCall:\nlm(formula = sqrt(count) ~ spray, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     3.7607       0.1160      -2.5158      -1.5963      -1.9512       0.2579  \n\nplot(simulateResiduals(m3))\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# GLM com distribuição Poisson (modelo para contagens)\n\nm4 &lt;- glm(count ~ spray, data = insetos, family = poisson)\nanova(m4)\n\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    \nNULL                     71     409.04              \nspray  5   310.71        66      98.33 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nAnova(m4)\n\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(&gt;Chisq)    \nspray   310.71  5  &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m4))\n\n\n\n\n\n\n\n# Médias ajustadas e comparação\nmedias_m4 &lt;- emmeans(m4, ~ spray, type = \"response\")\ncld(medias_m4)\n\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.100 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.180 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Interações entre tratamento e dose - antifúngicos\n\nantifungicos &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=2023059672#gid=2023059672\")\n\n# Gráfico de interação\ninteraction.plot(antifungicos$treat, antifungicos$dose, antifungicos$severity)\n\n\n\n\n\n\n\n# Visualizações individuais\np1 &lt;- antifungicos |&gt; \n  ggplot(aes(factor(dose), severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\np2 &lt;- antifungicos |&gt; \n  ggplot(aes(treat, severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\n# Combinação dos gráficos\np1 + p2\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação completo e diagnóstico\n\nm_anti &lt;- lm(severity ~ treat * dose, data = antifungicos)\nanova(m_anti)\n\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_anti))\n\n\n\n\n\n\n\n# Médias ajustadas por dose dentro de cada tratamento\nmedia_anti &lt;- emmeans(m_anti, ~ dose | treat)\nmedia_anti\n\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.2921 0.0273 16  0.23420   0.3500\n  2.0 0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.0210 0.0273 16 -0.03690   0.0789\n  2.0 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n\ncld(media_anti)\n\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Coeficiente de variação\ncv.model(m_anti)\n\n[1] 63.7165\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de oídio com AUDPC (épifoca)\n\noidio &lt;- PowderyMildew\n\n# Visualização inicial com filtragem\noidio |&gt; \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |&gt;  \n  ggplot(aes(time, sev)) +\n  geom_point() +\n  facet_grid(moisture ~ irrigation_type)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Cálculo do AUDPC e visualização por irrigação\n\noidio2 &lt;- oidio |&gt; \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\"))\n\noidio3 &lt;- oidio2 |&gt; \n  group_by(irrigation_type, moisture, block) |&gt; \n  summarize(AUDPC = AUDPC(time, sev), .groups = \"drop\")\n\noidio3 |&gt; \n  ggplot(aes(irrigation_type, AUDPC, color = moisture)) +\n  geom_point(size = 2) +\n  scale_y_continuous(limits = c(0, 20))\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação: AUDPC ~ irrigação * umidade\n\nmodel_oidio &lt;- lm(AUDPC ~ irrigation_type * moisture, data = oidio3)\nanova(model_oidio)\n\nAnalysis of Variance Table\n\nResponse: AUDPC\n                         Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nirrigation_type           2 134.341  67.170 451.721 5.073e-12 ***\nmoisture                  1   6.680   6.680  44.924 2.188e-05 ***\nirrigation_type:moisture  2   5.104   2.552  17.162 0.0003022 ***\nResiduals                12   1.784   0.149                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(model_oidio))\n\n\n\n\n\n\n\n# Médias ajustadas\nmedias_oidio &lt;- emmeans(model_oidio, ~ irrigation_type | moisture)\nmedias_oidio\n\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS                8.52 0.223 12     8.04     9.01\n MS above canopy   3.99 0.223 12     3.51     4.48\n Overhead          3.68 0.223 12     3.20     4.17\n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS               11.18 0.223 12    10.70    11.67\n MS above canopy   4.86 0.223 12     4.37     5.34\n Overhead          3.81 0.223 12     3.33     4.30\n\nConfidence level used: 0.95 \n\ncld(medias_oidio)\n\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.68 0.223 12     3.20     4.17  1    \n MS above canopy   3.99 0.223 12     3.51     4.48  1    \n MS                8.52 0.223 12     8.04     9.01   2   \n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.81 0.223 12     3.33     4.30  1    \n MS above canopy   4.86 0.223 12     4.37     5.34   2   \n MS               11.18 0.223 12    10.70    11.67    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Coeficiente de variação do modelo\ncv.model(model_oidio)\n\n[1] 6.418205"
  },
  {
    "objectID": "aula4.html#aula-4-23042025",
    "href": "aula4.html#aula-4-23042025",
    "title": "Aula 4 - Modelos Lineares Generalizados e Interações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAvaliar modelos com resíduos simulados (pacote DHARMa)\nIntroduzir modelos lineares generalizados (GLMs)\nAvaliar interações entre fatores com ANOVA e emmeans\nUsar transformações, identificar efeitos principais e interações\nGerar gráficos de interação e comparação de médias\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(DHARMa)\nlibrary(car)\nlibrary(multcomp)\nlibrary(emmeans)\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(agricolae)\nlibrary(epifitter)\n\n\n# ───────────────────────────────────────────────────────────────\ninsetos &lt;- InsectSprays\nm3 &lt;- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n\n\n\n\n\n\n\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n\n\n\n\n\n\n\nshapiro.test(residuals(m3))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n\nanova(m3)\n\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Avaliação de resíduos do modelo anterior (paramétrico)\n\nm3\n\n\nCall:\nlm(formula = sqrt(count) ~ spray, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     3.7607       0.1160      -2.5158      -1.5963      -1.9512       0.2579  \n\nplot(simulateResiduals(m3))\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# GLM com distribuição Poisson (modelo para contagens)\n\nm4 &lt;- glm(count ~ spray, data = insetos, family = poisson)\nanova(m4)\n\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    \nNULL                     71     409.04              \nspray  5   310.71        66      98.33 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nAnova(m4)\n\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(&gt;Chisq)    \nspray   310.71  5  &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m4))\n\n\n\n\n\n\n\n# Médias ajustadas e comparação\nmedias_m4 &lt;- emmeans(m4, ~ spray, type = \"response\")\ncld(medias_m4)\n\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.100 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.180 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Interações entre tratamento e dose - antifúngicos\n\nantifungicos &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=2023059672#gid=2023059672\")\n\n# Gráfico de interação\ninteraction.plot(antifungicos$treat, antifungicos$dose, antifungicos$severity)\n\n\n\n\n\n\n\n# Visualizações individuais\np1 &lt;- antifungicos |&gt; \n  ggplot(aes(factor(dose), severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\np2 &lt;- antifungicos |&gt; \n  ggplot(aes(treat, severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\n# Combinação dos gráficos\np1 + p2\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação completo e diagnóstico\n\nm_anti &lt;- lm(severity ~ treat * dose, data = antifungicos)\nanova(m_anti)\n\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_anti))\n\n\n\n\n\n\n\n# Médias ajustadas por dose dentro de cada tratamento\nmedia_anti &lt;- emmeans(m_anti, ~ dose | treat)\nmedia_anti\n\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.2921 0.0273 16  0.23420   0.3500\n  2.0 0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.0210 0.0273 16 -0.03690   0.0789\n  2.0 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n\ncld(media_anti)\n\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Coeficiente de variação\ncv.model(m_anti)\n\n[1] 63.7165\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de oídio com AUDPC (épifoca)\n\noidio &lt;- PowderyMildew\n\n# Visualização inicial com filtragem\noidio |&gt; \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |&gt;  \n  ggplot(aes(time, sev)) +\n  geom_point() +\n  facet_grid(moisture ~ irrigation_type)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Cálculo do AUDPC e visualização por irrigação\n\noidio2 &lt;- oidio |&gt; \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\"))\n\noidio3 &lt;- oidio2 |&gt; \n  group_by(irrigation_type, moisture, block) |&gt; \n  summarize(AUDPC = AUDPC(time, sev), .groups = \"drop\")\n\noidio3 |&gt; \n  ggplot(aes(irrigation_type, AUDPC, color = moisture)) +\n  geom_point(size = 2) +\n  scale_y_continuous(limits = c(0, 20))\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação: AUDPC ~ irrigação * umidade\n\nmodel_oidio &lt;- lm(AUDPC ~ irrigation_type * moisture, data = oidio3)\nanova(model_oidio)\n\nAnalysis of Variance Table\n\nResponse: AUDPC\n                         Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nirrigation_type           2 134.341  67.170 451.721 5.073e-12 ***\nmoisture                  1   6.680   6.680  44.924 2.188e-05 ***\nirrigation_type:moisture  2   5.104   2.552  17.162 0.0003022 ***\nResiduals                12   1.784   0.149                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(model_oidio))\n\n\n\n\n\n\n\n# Médias ajustadas\nmedias_oidio &lt;- emmeans(model_oidio, ~ irrigation_type | moisture)\nmedias_oidio\n\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS                8.52 0.223 12     8.04     9.01\n MS above canopy   3.99 0.223 12     3.51     4.48\n Overhead          3.68 0.223 12     3.20     4.17\n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS               11.18 0.223 12    10.70    11.67\n MS above canopy   4.86 0.223 12     4.37     5.34\n Overhead          3.81 0.223 12     3.33     4.30\n\nConfidence level used: 0.95 \n\ncld(medias_oidio)\n\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.68 0.223 12     3.20     4.17  1    \n MS above canopy   3.99 0.223 12     3.51     4.48  1    \n MS                8.52 0.223 12     8.04     9.01   2   \n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.81 0.223 12     3.33     4.30  1    \n MS above canopy   4.86 0.223 12     4.37     5.34   2   \n MS               11.18 0.223 12    10.70    11.67    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Coeficiente de variação do modelo\ncv.model(model_oidio)\n\n[1] 6.418205"
  },
  {
    "objectID": "aula2.html",
    "href": "aula2.html",
    "title": "Aula 2 - Importação e Manipulação de Dados",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nImportar dados de diferentes formatos (Excel, CSV e Google Sheets)\nManipular tabelas com dplyr, janitor e tidyverse\nAplicar funções como mutate(), filter(), group_by(), select() e tabyl()\nCriar visualizações básicas com ggplot2\nExportar gráficos com ggsave()\n\n\n# ───────────────────────────────────────────────────────────────\n# Carregamento dos pacotes\n\nlibrary(tidyverse)  # Conjunto de pacotes para análise e visualização de dados\nlibrary(readxl)     # Para leitura de arquivos Excel\nlibrary(dplyr)      # Manipulação de dados (parte do tidyverse)\n\n\n# ───────────────────────────────────────────────────────────────\n# Leitura de dados a partir de um arquivo Excel\n\ndados &lt;- read_excel(\"dados_diversos.xlsx\", sheet = \"sensibilidade_fungicidas\")\n\n# Transformando a variável 'dose' para o tipo numérico\ndados2 &lt;- dados |&gt; \n  mutate(dose = as.numeric(dose))\n\n\n# ───────────────────────────────────────────────────────────────\n# Importando dados diretamente de planilhas do Google Sheets\n\nlibrary(gsheet)  # Permite ler diretamente de links compartilhados\n\ndados_nuvem_analises &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?usp=sharing&ouid=114387405594168347966&rtpof=true&sd=true\")\ndados_nuvem_Mg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\nsurvey &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1118819738#gid=1118819738\")\n\n\n# ───────────────────────────────────────────────────────────────\n# Manipulações com dplyr\n\n# Contagem de observações por estado\ndados_estado &lt;- survey |&gt;\n  group_by(state) |&gt;\n  count()\n\n# Filtrando dados dos estados RS e PR\nRS &lt;- survey |&gt; filter(state == \"RS\")\nPR &lt;- survey |&gt; filter(state == \"PR\")\n\n# Combinando os dois conjuntos de dados\ncombinado &lt;- rbind(RS, PR)\n\n# Selecionando colunas específicas\nsurvey_b &lt;- survey |&gt; \n  dplyr::select(year, state, species)\n\n# Filtrando dados do ano de 2010\nsurvey_2010 &lt;- survey |&gt; \n  dplyr::select(year, state, species) |&gt; \n  filter(year == 2010)\n\n\n# ───────────────────────────────────────────────────────────────\n# Tabelas de contingência com janitor\n\nlibrary(janitor)\n\n# Frequência de espécies por estado e ano\nsurvey_b |&gt; \n  tabyl(state, species, year)\n\n$`2009`\n state Fgra Fspp\n    PR   92   31\n    RS  133    9\n\n$`2010`\n state Fgra Fspp\n    PR    0    0\n    RS  187   29\n\n$`2011`\n state Fgra Fspp\n    PR   58   35\n    RS   82   10\n\n# Frequência de espécies por ano\nsurvey_b |&gt; \n  tabyl(species, year)\n\n species 2009 2010 2011\n    Fgra  225  187  140\n    Fspp   40   29   45\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Gráfico de boxplot: efeito de tratamento com Mg\n\nMg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggthemes)\n\nPlot_Mg &lt;- Mg |&gt; \n  ggplot(aes(trat, comp)) +\n  geom_boxplot(fill = \"darkorange\", outline.color = NA) +\n  geom_jitter(width = 0.1, color = \"gray25\") +\n  scale_y_continuous(limits = c(5, 20)) +\n  labs(\n    x = \"Tratamentos\",  \n    y = \"Comprimento (mm)\", \n    title = \"Efeito do Mg\", \n    subtitle = \"Tamanho da lesão da mancha parda\",\n    caption = \"Fonte: Rodrigues et al. 2020\"\n  ) +\n  theme_clean() +\n  theme_minimal(base_size = 14)\n\n# Salvando o gráfico\nggsave(\"box.png\", bg = \"white\", width = 5, height = 5)\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Gráfico de crescimento micelial por espécie\n\nmicelial &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nplot_micelial &lt;- micelial |&gt;\n  ggplot(aes(reorder(especie, tcm), tcm)) +\n  geom_boxplot(fill = \"blue\", outline.color = NA) +\n  geom_jitter(width = 0.1, color = \"gray25\") +\n  coord_flip() +\n  theme(axis.title.x = element_text(face = \"italic\")) +\n  labs(x = \"Espécies\", y = \"Taxa de crescimento\")\n# Exibir\nplot_micelial\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Combinação dos dois gráficos com patchwork\n\nlibrary(patchwork)  # Facilita a junção de múltiplos gráficos no mesmo painel\n\n# Juntando os dois gráficos lado a lado, com letras A e B\n(Plot_Mg + plot_micelial) +\n  plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\n\n# Salvando o gráfico combinado\nggsave(\"combol.png\", bg = \"white\", width = 8, height = 5)"
  },
  {
    "objectID": "aula2.html#aula-2-26032025",
    "href": "aula2.html#aula-2-26032025",
    "title": "Aula 2 - Importação e Manipulação de Dados",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nImportar dados de diferentes formatos (Excel, CSV e Google Sheets)\nManipular tabelas com dplyr, janitor e tidyverse\nAplicar funções como mutate(), filter(), group_by(), select() e tabyl()\nCriar visualizações básicas com ggplot2\nExportar gráficos com ggsave()\n\n\n# ───────────────────────────────────────────────────────────────\n# Carregamento dos pacotes\n\nlibrary(tidyverse)  # Conjunto de pacotes para análise e visualização de dados\nlibrary(readxl)     # Para leitura de arquivos Excel\nlibrary(dplyr)      # Manipulação de dados (parte do tidyverse)\n\n\n# ───────────────────────────────────────────────────────────────\n# Leitura de dados a partir de um arquivo Excel\n\ndados &lt;- read_excel(\"dados_diversos.xlsx\", sheet = \"sensibilidade_fungicidas\")\n\n# Transformando a variável 'dose' para o tipo numérico\ndados2 &lt;- dados |&gt; \n  mutate(dose = as.numeric(dose))\n\n\n# ───────────────────────────────────────────────────────────────\n# Importando dados diretamente de planilhas do Google Sheets\n\nlibrary(gsheet)  # Permite ler diretamente de links compartilhados\n\ndados_nuvem_analises &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?usp=sharing&ouid=114387405594168347966&rtpof=true&sd=true\")\ndados_nuvem_Mg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\nsurvey &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1118819738#gid=1118819738\")\n\n\n# ───────────────────────────────────────────────────────────────\n# Manipulações com dplyr\n\n# Contagem de observações por estado\ndados_estado &lt;- survey |&gt;\n  group_by(state) |&gt;\n  count()\n\n# Filtrando dados dos estados RS e PR\nRS &lt;- survey |&gt; filter(state == \"RS\")\nPR &lt;- survey |&gt; filter(state == \"PR\")\n\n# Combinando os dois conjuntos de dados\ncombinado &lt;- rbind(RS, PR)\n\n# Selecionando colunas específicas\nsurvey_b &lt;- survey |&gt; \n  dplyr::select(year, state, species)\n\n# Filtrando dados do ano de 2010\nsurvey_2010 &lt;- survey |&gt; \n  dplyr::select(year, state, species) |&gt; \n  filter(year == 2010)\n\n\n# ───────────────────────────────────────────────────────────────\n# Tabelas de contingência com janitor\n\nlibrary(janitor)\n\n# Frequência de espécies por estado e ano\nsurvey_b |&gt; \n  tabyl(state, species, year)\n\n$`2009`\n state Fgra Fspp\n    PR   92   31\n    RS  133    9\n\n$`2010`\n state Fgra Fspp\n    PR    0    0\n    RS  187   29\n\n$`2011`\n state Fgra Fspp\n    PR   58   35\n    RS   82   10\n\n# Frequência de espécies por ano\nsurvey_b |&gt; \n  tabyl(species, year)\n\n species 2009 2010 2011\n    Fgra  225  187  140\n    Fspp   40   29   45\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Gráfico de boxplot: efeito de tratamento com Mg\n\nMg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggthemes)\n\nPlot_Mg &lt;- Mg |&gt; \n  ggplot(aes(trat, comp)) +\n  geom_boxplot(fill = \"darkorange\", outline.color = NA) +\n  geom_jitter(width = 0.1, color = \"gray25\") +\n  scale_y_continuous(limits = c(5, 20)) +\n  labs(\n    x = \"Tratamentos\",  \n    y = \"Comprimento (mm)\", \n    title = \"Efeito do Mg\", \n    subtitle = \"Tamanho da lesão da mancha parda\",\n    caption = \"Fonte: Rodrigues et al. 2020\"\n  ) +\n  theme_clean() +\n  theme_minimal(base_size = 14)\n\n# Salvando o gráfico\nggsave(\"box.png\", bg = \"white\", width = 5, height = 5)\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Gráfico de crescimento micelial por espécie\n\nmicelial &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\nplot_micelial &lt;- micelial |&gt;\n  ggplot(aes(reorder(especie, tcm), tcm)) +\n  geom_boxplot(fill = \"blue\", outline.color = NA) +\n  geom_jitter(width = 0.1, color = \"gray25\") +\n  coord_flip() +\n  theme(axis.title.x = element_text(face = \"italic\")) +\n  labs(x = \"Espécies\", y = \"Taxa de crescimento\")\n# Exibir\nplot_micelial\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Combinação dos dois gráficos com patchwork\n\nlibrary(patchwork)  # Facilita a junção de múltiplos gráficos no mesmo painel\n\n# Juntando os dois gráficos lado a lado, com letras A e B\n(Plot_Mg + plot_micelial) +\n  plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\n\n# Salvando o gráfico combinado\nggsave(\"combol.png\", bg = \"white\", width = 8, height = 5)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "aula3.html",
    "href": "aula3.html",
    "title": "Aula 3 - Testes Estatísticos e Visualizações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar testes estatísticos (t de Student, ANOVA, Kruskal-Wallis, Shapiro-Wilk, Levene)\nComparar dois grupos com t.test()\nVerificar pressupostos de normalidade e homocedasticidade\nUsar modelos lineares (lm), ANOVA e transformações\nVisualizar resultados com ggplot2 e ggpubr\nTrabalhar com dados paramétricos e não-paramétricos\nRealizar testes de médias (emmeans, multcomp)\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)        # Importa dados diretamente de planilhas Google Sheets\nlibrary(tidyverse)     # Conjunto de pacotes para manipulação de dados (dplyr, tidyr, etc.)\nlibrary(ggplot2)       # Criação de gráficos baseados no Grammar of Graphics\nlibrary(ggpubr)        # Extensões do ggplot2 com suporte a estatísticas e temas prontos\nlibrary(report)        # Gera interpretações automáticas e legíveis de testes estatísticos\nlibrary(rstatix)       # Funções simplificadas para testes estatísticos (t, ANOVA, Levene, etc.)\nlibrary(emmeans)       # Estima e compara médias ajustadas de modelos (muito útil pós-ANOVA)\nlibrary(multcomp)      # Permite contrastes múltiplos e testes de comparações múltiplas\nlibrary(multcompView)  # Gera letras compactas para visualização de grupos estatisticamente distintos\nlibrary(car)           # Contém o teste de Levene (leveneTest) e outras funções para modelos lineares\nlibrary(agricolae)     # Para o teste de Kruskal com agrupamento de médias\n\n\n# ───────────────────────────────────────────────────────────────\n# Importando dados para comparação entre tratamentos\n\ndata_Mg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\n# Visualização inicial: dispersão dos valores por tratamento\ndata_Mg |&gt;  \n  ggplot(aes(trat, comp)) +\n  geom_jitter(width = 0.1)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Preparação dos dados para teste t de Student (dois grupos)\n\n# Transforma o data frame para formato wide: colunas separadas para cada grupo\ndata_Mg2 &lt;- data_Mg |&gt; \n  pivot_wider(names_from = trat, values_from = comp) |&gt; \n  select(-rep)  # Remove coluna de repetições (caso exista)\n\n# Teste t para dois grupos (não pareado)\nattach(data_Mg2)  # Acessar colunas diretamente (Mg2 e control)\nt_results &lt;- t.test(Mg2, control, var.equal = FALSE)\n\n# Relatório interpretável do teste\ntest_report &lt;- report(t_results)\ntest_report\n\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between Mg2 and control\n(mean of x = 10.52, mean of y = 15.68) suggests that the effect is negative,\nstatistically significant, and large (difference = -5.16, 95% CI [-6.49,\n-3.83], t(17.35) = -8.15, p &lt; .001; Cohen's d = -3.65, 95% CI [-5.12, -2.14])\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Teste t usando fórmula e comparação com ggplot\n\ntest &lt;- t_test(comp ~ trat, data = data_Mg)\n\n# Gráfico com comparação dos grupos e valor de p\np &lt;- ggboxplot(\n  data_Mg, x = \"trat\", y = \"comp\",\n  color = \"trat\", palette = \"jco\")\n\n# Adiciona valor de p ao gráfico\np + \n  stat_pvalue_manual(test, label = \"p\", y.position = 18) +\n  ylim(0, 20) +\n  labs(x = \"Tratamento\", y = \"Comprimento (mm)\")\n\n\n\n\n\n\n\nggsave(\"plot2.png\", bg = \"white\")\n\n\n# ───────────────────────────────────────────────────────────────\n# Testes de pressupostos estatísticos\n\n# Normalidade (Shapiro-Wilk)\nshapiro.test(data_Mg2$Mg2)\n\n\n    Shapiro-Wilk normality test\n\ndata:  data_Mg2$Mg2\nW = 0.97269, p-value = 0.9146\n\nshapiro.test(data_Mg2$control)\n\n\n    Shapiro-Wilk normality test\n\ndata:  data_Mg2$control\nW = 0.93886, p-value = 0.5404\n\n# Histogramas para avaliar distribuição visual\nhist(data_Mg2$Mg2)\n\n\n\n\n\n\n\nhist(data_Mg2$control)\n\n\n\n\n\n\n\n# Teste de homogeneidade de variâncias (F-test)\nvar.test(data_Mg2$Mg2, data_Mg2$control)\n\n\n    F test to compare two variances\n\ndata:  data_Mg2$Mg2 and data_Mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de dados emparelhados – estudo de acurácia\n\nescala &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\n# Teste t para dados pareados entre dois métodos de avaliação\nt_test(acuracia ~ assessment, data = escala, paired = TRUE, var.equal = FALSE)\n\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1 acuracia Aided1 Unaided    10    10      4.42     9 0.00167\n\n# Visualização com boxplot\nescala |&gt; \n  ggplot(aes(assessment, acuracia)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Comparação direta entre duas categorias específicas\n\nunaided &lt;- escala |&gt; \n  filter(assessment == \"Unaided\") |&gt; \n  select(acuracia) |&gt; \n  pull()\n\naided &lt;- escala |&gt; \n  filter(assessment == \"Aided1\") |&gt; \n  select(acuracia) |&gt; \n  pull()\n\n# Teste F para variâncias\nvar.test(unaided, aided)\n\n\n    F test to compare two variances\n\ndata:  unaided and aided\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n\n# Verificação de normalidade\nhist(aided)\n\n\n\n\n\n\n\nshapiro.test(unaided)\n\n\n    Shapiro-Wilk normality test\n\ndata:  unaided\nW = 0.7748, p-value = 0.007155\n\nshapiro.test(aided)\n\n\n    Shapiro-Wilk normality test\n\ndata:  aided\nW = 0.92852, p-value = 0.4335\n\n# Teste t pareado entre os dois grupos\nt.test(unaided, aided, paired = TRUE, var.equal = FALSE)\n\n\n    Paired t-test\n\ndata:  unaided and aided\nt = -4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -0.3552353 -0.1147647\nsample estimates:\nmean difference \n         -0.235 \n\n# Teste não-paramétrico de Wilcoxon (caso normalidade não seja atendida)\nwilcox.test(unaided)\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  unaided\nV = 55, p-value = 0.005857\nalternative hypothesis: true location is not equal to 0\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Dados de crescimento micelial por espécie (ANOVA)\n\nmicelial &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualização: dispersão por espécie\nmicelial |&gt; \n  ggplot(aes(especie, tcm)) +\n  geom_jitter(width = 0.1)\n\n\n\n\n\n\n\n# Modelos para análise de variância\nanova1 &lt;- aov(tcm ~ especie, data = micelial)      # ANOVA tradicional\nanova2 &lt;- lm(tcm ~ especie, data = micelial)       # Modelo linear equivalente\n\n# Sumário dos testes\nanova(anova1)\n\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nanova(anova2)\n\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Diagnóstico de resíduos\nhist(residuals(anova1))\n\n\n\n\n\n\n\nshapiro.test(residuals(anova1))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.9821, p-value = 0.8782\n\nbartlett.test(tcm ~ especie, data = micelial)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n\nlevene_test(tcm ~ especie, data = micelial)\n\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;\n1     4    25      1.76 0.169\n\n# Testes de médias\nm &lt;- emmeans(anova2, ~ especie)\nm\n\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n\ncld(m)  # Compact letter display\n\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Exemplo clássico: InsectSprays\n\ninsetos &lt;- InsectSprays\n\n# Visualização\ninsetos |&gt; \n  ggplot(aes(spray, count)) +\n  geom_jitter(width = 0.1) +\n  geom_boxplot(outlier.color = NA)\n\n\n\n\n\n\n\n# Ajuste do modelo e diagnóstico\nm2 &lt;- lm(count ~ spray, data = insetos)\nshapiro.test(residuals(m2))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m2)\nW = 0.96006, p-value = 0.02226\n\nbartlett.test(count ~ spray, data = insetos)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n\nlevene_test(count ~ spray, data = insetos)\n\n# A tibble: 1 × 4\n    df1   df2 statistic       p\n  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1     5    66      3.82 0.00422\n\nanova(m2)\n\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 2668.8  533.77  34.702 &lt; 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nhist(residuals(m2))\n\n\n\n\n\n\n\nqqnorm(residuals(m2))\nqqline(residuals(m2))\n\n\n\n\n\n\n\n# Alternativa 1 – Transformação da resposta (sqrt)\nm3 &lt;- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n\n\n\n\n\n\n\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n\n\n\n\n\n\n\nshapiro.test(residuals(m3))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n\nanova(m3)\n\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nm33 &lt;- emmeans(m3, ~ spray, type = \"response\")\ncld(m33)\n\n spray response    SE df lower.CL upper.CL .group\n C         1.55 0.452 66    0.779     2.58  1    \n E         3.27 0.656 66    2.095     4.72  12   \n D         4.68 0.785 66    3.248     6.38   2   \n A        14.14 1.360 66   11.550    17.00    3  \n B        15.03 1.410 66   12.352    17.97    3  \n F        16.15 1.460 66   13.370    19.19    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\nplot(m33)\n\n\n\n\n\n\n\n# Alternativa 2 – Teste não-paramétrico de Kruskal-Wallis\nkruskal.test(count ~ spray, data = insetos)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n\nkruskal(insetos$count, insetos$spray, group = TRUE, console = TRUE)\n\n\nStudy: insetos$count ~ insetos$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\ninsetos$spray,  means of the ranks\n\n  insetos.count  r\nA      52.16667 12\nB      54.83333 12\nC      11.45833 12\nD      25.58333 12\nE      19.33333 12\nF      55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  insetos$count groups\nF      55.62500      a\nB      54.83333      a\nA      52.16667      a\nD      25.58333      b\nE      19.33333     bc\nC      11.45833      c"
  },
  {
    "objectID": "aula3.html#aula-3-16042025",
    "href": "aula3.html#aula-3-16042025",
    "title": "Aula 3 - Testes Estatísticos e Visualizações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar testes estatísticos (t de Student, ANOVA, Kruskal-Wallis, Shapiro-Wilk, Levene)\nComparar dois grupos com t.test()\nVerificar pressupostos de normalidade e homocedasticidade\nUsar modelos lineares (lm), ANOVA e transformações\nVisualizar resultados com ggplot2 e ggpubr\nTrabalhar com dados paramétricos e não-paramétricos\nRealizar testes de médias (emmeans, multcomp)\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)        # Importa dados diretamente de planilhas Google Sheets\nlibrary(tidyverse)     # Conjunto de pacotes para manipulação de dados (dplyr, tidyr, etc.)\nlibrary(ggplot2)       # Criação de gráficos baseados no Grammar of Graphics\nlibrary(ggpubr)        # Extensões do ggplot2 com suporte a estatísticas e temas prontos\nlibrary(report)        # Gera interpretações automáticas e legíveis de testes estatísticos\nlibrary(rstatix)       # Funções simplificadas para testes estatísticos (t, ANOVA, Levene, etc.)\nlibrary(emmeans)       # Estima e compara médias ajustadas de modelos (muito útil pós-ANOVA)\nlibrary(multcomp)      # Permite contrastes múltiplos e testes de comparações múltiplas\nlibrary(multcompView)  # Gera letras compactas para visualização de grupos estatisticamente distintos\nlibrary(car)           # Contém o teste de Levene (leveneTest) e outras funções para modelos lineares\nlibrary(agricolae)     # Para o teste de Kruskal com agrupamento de médias\n\n\n# ───────────────────────────────────────────────────────────────\n# Importando dados para comparação entre tratamentos\n\ndata_Mg &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\n# Visualização inicial: dispersão dos valores por tratamento\ndata_Mg |&gt;  \n  ggplot(aes(trat, comp)) +\n  geom_jitter(width = 0.1)\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Preparação dos dados para teste t de Student (dois grupos)\n\n# Transforma o data frame para formato wide: colunas separadas para cada grupo\ndata_Mg2 &lt;- data_Mg |&gt; \n  pivot_wider(names_from = trat, values_from = comp) |&gt; \n  select(-rep)  # Remove coluna de repetições (caso exista)\n\n# Teste t para dois grupos (não pareado)\nattach(data_Mg2)  # Acessar colunas diretamente (Mg2 e control)\nt_results &lt;- t.test(Mg2, control, var.equal = FALSE)\n\n# Relatório interpretável do teste\ntest_report &lt;- report(t_results)\ntest_report\n\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between Mg2 and control\n(mean of x = 10.52, mean of y = 15.68) suggests that the effect is negative,\nstatistically significant, and large (difference = -5.16, 95% CI [-6.49,\n-3.83], t(17.35) = -8.15, p &lt; .001; Cohen's d = -3.65, 95% CI [-5.12, -2.14])\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Teste t usando fórmula e comparação com ggplot\n\ntest &lt;- t_test(comp ~ trat, data = data_Mg)\n\n# Gráfico com comparação dos grupos e valor de p\np &lt;- ggboxplot(\n  data_Mg, x = \"trat\", y = \"comp\",\n  color = \"trat\", palette = \"jco\")\n\n# Adiciona valor de p ao gráfico\np + \n  stat_pvalue_manual(test, label = \"p\", y.position = 18) +\n  ylim(0, 20) +\n  labs(x = \"Tratamento\", y = \"Comprimento (mm)\")\n\n\n\n\n\n\n\nggsave(\"plot2.png\", bg = \"white\")\n\n\n# ───────────────────────────────────────────────────────────────\n# Testes de pressupostos estatísticos\n\n# Normalidade (Shapiro-Wilk)\nshapiro.test(data_Mg2$Mg2)\n\n\n    Shapiro-Wilk normality test\n\ndata:  data_Mg2$Mg2\nW = 0.97269, p-value = 0.9146\n\nshapiro.test(data_Mg2$control)\n\n\n    Shapiro-Wilk normality test\n\ndata:  data_Mg2$control\nW = 0.93886, p-value = 0.5404\n\n# Histogramas para avaliar distribuição visual\nhist(data_Mg2$Mg2)\n\n\n\n\n\n\n\nhist(data_Mg2$control)\n\n\n\n\n\n\n\n# Teste de homogeneidade de variâncias (F-test)\nvar.test(data_Mg2$Mg2, data_Mg2$control)\n\n\n    F test to compare two variances\n\ndata:  data_Mg2$Mg2 and data_Mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de dados emparelhados – estudo de acurácia\n\nescala &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\n# Teste t para dados pareados entre dois métodos de avaliação\nt_test(acuracia ~ assessment, data = escala, paired = TRUE, var.equal = FALSE)\n\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1 acuracia Aided1 Unaided    10    10      4.42     9 0.00167\n\n# Visualização com boxplot\nescala |&gt; \n  ggplot(aes(assessment, acuracia)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Comparação direta entre duas categorias específicas\n\nunaided &lt;- escala |&gt; \n  filter(assessment == \"Unaided\") |&gt; \n  select(acuracia) |&gt; \n  pull()\n\naided &lt;- escala |&gt; \n  filter(assessment == \"Aided1\") |&gt; \n  select(acuracia) |&gt; \n  pull()\n\n# Teste F para variâncias\nvar.test(unaided, aided)\n\n\n    F test to compare two variances\n\ndata:  unaided and aided\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n\n# Verificação de normalidade\nhist(aided)\n\n\n\n\n\n\n\nshapiro.test(unaided)\n\n\n    Shapiro-Wilk normality test\n\ndata:  unaided\nW = 0.7748, p-value = 0.007155\n\nshapiro.test(aided)\n\n\n    Shapiro-Wilk normality test\n\ndata:  aided\nW = 0.92852, p-value = 0.4335\n\n# Teste t pareado entre os dois grupos\nt.test(unaided, aided, paired = TRUE, var.equal = FALSE)\n\n\n    Paired t-test\n\ndata:  unaided and aided\nt = -4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -0.3552353 -0.1147647\nsample estimates:\nmean difference \n         -0.235 \n\n# Teste não-paramétrico de Wilcoxon (caso normalidade não seja atendida)\nwilcox.test(unaided)\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  unaided\nV = 55, p-value = 0.005857\nalternative hypothesis: true location is not equal to 0\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Dados de crescimento micelial por espécie (ANOVA)\n\nmicelial &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualização: dispersão por espécie\nmicelial |&gt; \n  ggplot(aes(especie, tcm)) +\n  geom_jitter(width = 0.1)\n\n\n\n\n\n\n\n# Modelos para análise de variância\nanova1 &lt;- aov(tcm ~ especie, data = micelial)      # ANOVA tradicional\nanova2 &lt;- lm(tcm ~ especie, data = micelial)       # Modelo linear equivalente\n\n# Sumário dos testes\nanova(anova1)\n\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nanova(anova2)\n\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Diagnóstico de resíduos\nhist(residuals(anova1))\n\n\n\n\n\n\n\nshapiro.test(residuals(anova1))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.9821, p-value = 0.8782\n\nbartlett.test(tcm ~ especie, data = micelial)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n\nlevene_test(tcm ~ especie, data = micelial)\n\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;\n1     4    25      1.76 0.169\n\n# Testes de médias\nm &lt;- emmeans(anova2, ~ especie)\nm\n\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n\ncld(m)  # Compact letter display\n\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Exemplo clássico: InsectSprays\n\ninsetos &lt;- InsectSprays\n\n# Visualização\ninsetos |&gt; \n  ggplot(aes(spray, count)) +\n  geom_jitter(width = 0.1) +\n  geom_boxplot(outlier.color = NA)\n\n\n\n\n\n\n\n# Ajuste do modelo e diagnóstico\nm2 &lt;- lm(count ~ spray, data = insetos)\nshapiro.test(residuals(m2))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m2)\nW = 0.96006, p-value = 0.02226\n\nbartlett.test(count ~ spray, data = insetos)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n\nlevene_test(count ~ spray, data = insetos)\n\n# A tibble: 1 × 4\n    df1   df2 statistic       p\n  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1     5    66      3.82 0.00422\n\nanova(m2)\n\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 2668.8  533.77  34.702 &lt; 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nhist(residuals(m2))\n\n\n\n\n\n\n\nqqnorm(residuals(m2))\nqqline(residuals(m2))\n\n\n\n\n\n\n\n# Alternativa 1 – Transformação da resposta (sqrt)\nm3 &lt;- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n\n\n\n\n\n\n\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n\n\n\n\n\n\n\nshapiro.test(residuals(m3))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n\nanova(m3)\n\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nspray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nm33 &lt;- emmeans(m3, ~ spray, type = \"response\")\ncld(m33)\n\n spray response    SE df lower.CL upper.CL .group\n C         1.55 0.452 66    0.779     2.58  1    \n E         3.27 0.656 66    2.095     4.72  12   \n D         4.68 0.785 66    3.248     6.38   2   \n A        14.14 1.360 66   11.550    17.00    3  \n B        15.03 1.410 66   12.352    17.97    3  \n F        16.15 1.460 66   13.370    19.19    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\nplot(m33)\n\n\n\n\n\n\n\n# Alternativa 2 – Teste não-paramétrico de Kruskal-Wallis\nkruskal.test(count ~ spray, data = insetos)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n\nkruskal(insetos$count, insetos$spray, group = TRUE, console = TRUE)\n\n\nStudy: insetos$count ~ insetos$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\ninsetos$spray,  means of the ranks\n\n  insetos.count  r\nA      52.16667 12\nB      54.83333 12\nC      11.45833 12\nD      25.58333 12\nE      19.33333 12\nF      55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  insetos$count groups\nF      55.62500      a\nB      54.83333      a\nA      52.16667      a\nD      25.58333      b\nE      19.33333     bc\nC      11.45833      c"
  },
  {
    "objectID": "aula5.html",
    "href": "aula5.html",
    "title": "Aula 5 - Modelos Mistos, Transformações e Correlações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar modelos lineares com blocos\nInterpretar modelos mistos com o pacote lme4\nCalcular médias ajustadas e fazer comparações múltiplas\nAvaliar resíduos simulados com DHARMa\nExplorar relações entre variáveis por meio de correlações e regressão\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(report)\nlibrary(rstatix)\nlibrary(agricolae)\nlibrary(epifitter)\nlibrary(car)\nlibrary(multcomp)\nlibrary(DHARMa)\nlibrary(multcompView)\nlibrary(emmeans)\nlibrary(patchwork)\nlibrary(lme4)\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de experimento em campo (tratamentos x produtividade)\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Visualização inicial\ncampo |&gt; \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.1) +\n  stat_summary(fun.data = 'mean_cl_boot', colour = 'red', width = 0.3)\n\n\n\n\n\n\n\n# Conversão de variáveis para fator\ncampo$TRAR &lt;- factor(campo$TRAT)\ncampo$BLOCO &lt;- factor(campo$BLOCO)\n\n# Modelo com transformação logarítmica (para FER)\nm_campo &lt;- lm(log(FER) ~ BLOCO + TRAT, data = campo)\nanova(m_campo)\n\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nBLOCO      3 0.2064  0.0688  0.2825   0.8375    \nTRAT       1 5.7509  5.7509 23.6174 4.44e-05 ***\nResiduals 27 6.5745  0.2435                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_campo))\n\n\n\n\n\n\n\n# Médias ajustadas\nmeans_campo &lt;- emmeans(m_campo, ~ TRAT, type = \"response\")\nmeans_campo\n\n TRAT response    SE df lower.CL upper.CL\n  4.5     4.44 0.387 27     3.71     5.31\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n\ncv.model(m_campo)\n\n[1] 33.10603\n\nplot(means_campo)\n\n\n\n\n\n\n\ncld(means_campo)\n\n TRAT response    SE df lower.CL upper.CL .group\n  4.5     4.44 0.387 27     3.71     5.31  1    \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nNote: contrasts are still on the log scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\npwpm(means_campo)\n\n       4.5\n4.5 [4.44]\n\nRow and column labels: TRAT\nUpper triangle: P values \nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (estimate)   earlier vs. later\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Dados de milho híbrido\n\nmilho &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualização por método e híbrido\nmilho |&gt; \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n\n\n\n\n\n\n\n# Criação de bloco aninhado (modelo misto)\nmilho$hybrid_block &lt;- interaction(milho$hybrid, milho$block)\n\n# Modelo misto para índice\nm_milho &lt;- lmer(index ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(&gt;Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_milho))\n\n\n\n\n\n\n\nmedia_milho &lt;- emmeans(m_milho, ~ method | hybrid)\ncld(media_milho, Letters = letters)\n\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     25.0 3.57 24.9     17.7     32.3  a    \n pin      25.3 3.57 24.9     17.9     32.6  a    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      24.6 3.57 24.9     17.3     31.9  a    \n silk     26.2 3.57 24.9     18.9     33.6  a    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      20.6 3.57 24.9     13.2     27.9  a    \n silk     21.5 3.57 24.9     14.2     28.8  a    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.5 3.57 24.9     19.2     33.8  a    \n pin      38.1 3.57 24.9     30.8     45.4   b   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.6 3.57 24.9     19.3     34.0  a    \n pin      32.5 3.57 24.9     25.2     39.8  a    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     19.2 3.57 24.9     11.8     26.5  a    \n pin      19.4 3.57 24.9     12.1     26.8  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Modelo misto para produtividade\nyield_model &lt;- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(yield_model)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yield\n                Chisq Df Pr(&gt;Chisq)    \nhybrid        22.5966  5  0.0004031 ***\nmethod         0.1052  1  0.7456932    \nhybrid:method 25.9302  5  9.206e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(yield_model))\n\n\n\n\n\n\n\nmedia_milho2 &lt;- emmeans(yield_model, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n\nhybrid = 30F53 HX:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9988 798 21.1     8328    11647  a    \n pin     11208 798 21.1     9548    12867   b   \n\nhybrid = 30F53 YH:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9211 798 21.1     7552    10870  a    \n pin      9408 798 21.1     7748    11067  a    \n\nhybrid = 30K64:\n method emmean  SE   df lower.CL upper.CL .group\n silk    10361 798 21.1     8702    12020  a    \n pin     11675 798 21.1    10016    13334   b   \n\nhybrid = 30S31H:\n method emmean  SE   df lower.CL upper.CL .group\n pin      8118 798 21.1     6459     9777  a    \n silk     9185 798 21.1     7526    10844   b   \n\nhybrid = 30S31YH:\n method emmean  SE   df lower.CL upper.CL .group\n pin      7836 798 21.1     6177     9495  a    \n silk     8277 798 21.1     6618     9936  a    \n\nhybrid = BG7049H:\n method emmean  SE   df lower.CL upper.CL .group\n pin     11970 798 21.1    10311    13629  a    \n silk    12833 798 21.1    11174    14492  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Correlação entre variáveis de desempenho (índice vs produtividade)\n\nmilho |&gt; \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n\n\n\n\n\n\ncor1 &lt;- cor(milho$index, milho$yield)\ncor1 * cor1 * 100\n\n[1] 6.323713\n\ncor.test(milho$index, milho$yield)\n\n\n    Pearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699 \n\n# Correlação em dados de campo\ncor(campo$FER, campo$PROD)\n\n[1] -0.6258321\n\ncor.test(campo$FER, campo$DFC)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo$FER and campo$DFC\nt = 14.049, df = 30, p-value = 9.864e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8635525 0.9664228\nsample estimates:\n      cor \n0.9316978 \n\ncampo |&gt; \n  ggplot(aes(FER, DFC)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")"
  },
  {
    "objectID": "aula5.html#aula-5-30042025",
    "href": "aula5.html#aula-5-30042025",
    "title": "Aula 5 - Modelos Mistos, Transformações e Correlações",
    "section": "",
    "text": "Professor: Emerson Del Ponte\n\n\n\nAplicar modelos lineares com blocos\nInterpretar modelos mistos com o pacote lme4\nCalcular médias ajustadas e fazer comparações múltiplas\nAvaliar resíduos simulados com DHARMa\nExplorar relações entre variáveis por meio de correlações e regressão\n\n\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(report)\nlibrary(rstatix)\nlibrary(agricolae)\nlibrary(epifitter)\nlibrary(car)\nlibrary(multcomp)\nlibrary(DHARMa)\nlibrary(multcompView)\nlibrary(emmeans)\nlibrary(patchwork)\nlibrary(lme4)\n\n\n# ───────────────────────────────────────────────────────────────\n# Análise de experimento em campo (tratamentos x produtividade)\n\ncampo &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Visualização inicial\ncampo |&gt; \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.1) +\n  stat_summary(fun.data = 'mean_cl_boot', colour = 'red', width = 0.3)\n\n\n\n\n\n\n\n# Conversão de variáveis para fator\ncampo$TRAR &lt;- factor(campo$TRAT)\ncampo$BLOCO &lt;- factor(campo$BLOCO)\n\n# Modelo com transformação logarítmica (para FER)\nm_campo &lt;- lm(log(FER) ~ BLOCO + TRAT, data = campo)\nanova(m_campo)\n\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nBLOCO      3 0.2064  0.0688  0.2825   0.8375    \nTRAT       1 5.7509  5.7509 23.6174 4.44e-05 ***\nResiduals 27 6.5745  0.2435                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_campo))\n\n\n\n\n\n\n\n# Médias ajustadas\nmeans_campo &lt;- emmeans(m_campo, ~ TRAT, type = \"response\")\nmeans_campo\n\n TRAT response    SE df lower.CL upper.CL\n  4.5     4.44 0.387 27     3.71     5.31\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n\ncv.model(m_campo)\n\n[1] 33.10603\n\nplot(means_campo)\n\n\n\n\n\n\n\ncld(means_campo)\n\n TRAT response    SE df lower.CL upper.CL .group\n  4.5     4.44 0.387 27     3.71     5.31  1    \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nNote: contrasts are still on the log scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\npwpm(means_campo)\n\n       4.5\n4.5 [4.44]\n\nRow and column labels: TRAT\nUpper triangle: P values \nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (estimate)   earlier vs. later\n\n\n\n# ───────────────────────────────────────────────────────────────\n# Dados de milho híbrido\n\nmilho &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualização por método e híbrido\nmilho |&gt; \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n\n\n\n\n\n\n\n# Criação de bloco aninhado (modelo misto)\nmilho$hybrid_block &lt;- interaction(milho$hybrid, milho$block)\n\n# Modelo misto para índice\nm_milho &lt;- lmer(index ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(&gt;Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(m_milho))\n\n\n\n\n\n\n\nmedia_milho &lt;- emmeans(m_milho, ~ method | hybrid)\ncld(media_milho, Letters = letters)\n\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     25.0 3.57 24.9     17.7     32.3  a    \n pin      25.3 3.57 24.9     17.9     32.6  a    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      24.6 3.57 24.9     17.3     31.9  a    \n silk     26.2 3.57 24.9     18.9     33.6  a    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      20.6 3.57 24.9     13.2     27.9  a    \n silk     21.5 3.57 24.9     14.2     28.8  a    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.5 3.57 24.9     19.2     33.8  a    \n pin      38.1 3.57 24.9     30.8     45.4   b   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.6 3.57 24.9     19.3     34.0  a    \n pin      32.5 3.57 24.9     25.2     39.8  a    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     19.2 3.57 24.9     11.8     26.5  a    \n pin      19.4 3.57 24.9     12.1     26.8  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n# Modelo misto para produtividade\nyield_model &lt;- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(yield_model)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yield\n                Chisq Df Pr(&gt;Chisq)    \nhybrid        22.5966  5  0.0004031 ***\nmethod         0.1052  1  0.7456932    \nhybrid:method 25.9302  5  9.206e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nplot(simulateResiduals(yield_model))\n\n\n\n\n\n\n\nmedia_milho2 &lt;- emmeans(yield_model, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n\nhybrid = 30F53 HX:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9988 798 21.1     8328    11647  a    \n pin     11208 798 21.1     9548    12867   b   \n\nhybrid = 30F53 YH:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9211 798 21.1     7552    10870  a    \n pin      9408 798 21.1     7748    11067  a    \n\nhybrid = 30K64:\n method emmean  SE   df lower.CL upper.CL .group\n silk    10361 798 21.1     8702    12020  a    \n pin     11675 798 21.1    10016    13334   b   \n\nhybrid = 30S31H:\n method emmean  SE   df lower.CL upper.CL .group\n pin      8118 798 21.1     6459     9777  a    \n silk     9185 798 21.1     7526    10844   b   \n\nhybrid = 30S31YH:\n method emmean  SE   df lower.CL upper.CL .group\n pin      7836 798 21.1     6177     9495  a    \n silk     8277 798 21.1     6618     9936  a    \n\nhybrid = BG7049H:\n method emmean  SE   df lower.CL upper.CL .group\n pin     11970 798 21.1    10311    13629  a    \n silk    12833 798 21.1    11174    14492  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\n\n# ───────────────────────────────────────────────────────────────\n# Correlação entre variáveis de desempenho (índice vs produtividade)\n\nmilho |&gt; \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n\n\n\n\n\n\ncor1 &lt;- cor(milho$index, milho$yield)\ncor1 * cor1 * 100\n\n[1] 6.323713\n\ncor.test(milho$index, milho$yield)\n\n\n    Pearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699 \n\n# Correlação em dados de campo\ncor(campo$FER, campo$PROD)\n\n[1] -0.6258321\n\ncor.test(campo$FER, campo$DFC)\n\n\n    Pearson's product-moment correlation\n\ndata:  campo$FER and campo$DFC\nt = 14.049, df = 30, p-value = 9.864e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8635525 0.9664228\nsample estimates:\n      cor \n0.9316978 \n\ncampo |&gt; \n  ggplot(aes(FER, DFC)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "PTN Blog",
    "section": "",
    "text": "Olá! Meu nome é Pedro Thiagos Santos Nogueira, sou Engenheiro Agrônomo, formado pela Universidade Federal de Viçosa (UFV). Desde cedo, desenvolvi interesse pelas interações entre fungos e plantas, o que me levou a seguir uma trajetória acadêmica voltada à micologia. Realizei meu mestrado em Fitopatologia, com ênfase em taxonomia de fungos, e atualmente curso o doutorado no mesmo programa, vinculado ao Departamento de Fitopatologia da UFV.\nAtuo no Micolab, laboratório de referência em micologia da UFV, sob orientação do Prof. Dr. Olinto Liparini Pereira, onde desenvolvo pesquisas voltadas à diversidade, sistemática e ecologia de fungos fitopatogênicos e endofíticos. Além disso, sou membro conselheiro da L.A. Fungi – Liga Acadêmica de Estudo e Pesquisa em Micologia, iniciativa dedicada à difusão do conhecimento micológico."
  },
  {
    "objectID": "index.html#sobre-mim",
    "href": "index.html#sobre-mim",
    "title": "PTN Blog",
    "section": "",
    "text": "Olá! Meu nome é Pedro Thiagos Santos Nogueira, sou Engenheiro Agrônomo, formado pela Universidade Federal de Viçosa (UFV). Desde cedo, desenvolvi interesse pelas interações entre fungos e plantas, o que me levou a seguir uma trajetória acadêmica voltada à micologia. Realizei meu mestrado em Fitopatologia, com ênfase em taxonomia de fungos, e atualmente curso o doutorado no mesmo programa, vinculado ao Departamento de Fitopatologia da UFV.\nAtuo no Micolab, laboratório de referência em micologia da UFV, sob orientação do Prof. Dr. Olinto Liparini Pereira, onde desenvolvo pesquisas voltadas à diversidade, sistemática e ecologia de fungos fitopatogênicos e endofíticos. Além disso, sou membro conselheiro da L.A. Fungi – Liga Acadêmica de Estudo e Pesquisa em Micologia, iniciativa dedicada à difusão do conhecimento micológico."
  },
  {
    "objectID": "index.html#sobre-este-site",
    "href": "index.html#sobre-este-site",
    "title": "PTN Blog",
    "section": "Sobre este site",
    "text": "Sobre este site\nEste site foi desenvolvido em Quarto Markdown como parte das atividades da disciplina\nFIP606 – Análise e Visualização de Dados em Fitopatologia, ministrada pelo Prof. Dr. Emerson Del Ponte. Aqui, organizei os conteúdos abordados ao longo da disciplina, com scripts comentados. Sinta-se convidado(a) a navegar pelos conteúdos e explorar o potencial do R e da visualização de dados no entendimento de sistemas fitopatológicos."
  }
]