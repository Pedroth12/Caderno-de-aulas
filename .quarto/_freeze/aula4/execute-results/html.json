{
  "hash": "ce3b8f8ae3f9bee5536b67638f310e89",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 4 - Modelos Lineares Generalizados e Interações\"\nauthor: \"Pedro Thiagos Santos Nogueira\"\ndate: \"2025-04-23\"\nformat: html\neditor: visual\n---\n\n\n\n\n## Aula 4 – 23/04/2025\n\n### Disciplina: FIP606 – Análise e Visualização de Dados em Fitopatologia\n\n**Professor:** Emerson Del Ponte\n\n#### ✦ Objetivos da aula:\n\n-   Avaliar modelos com resíduos simulados (pacote `DHARMa`)\n-   Introduzir modelos lineares generalizados (GLMs)\n-   Avaliar interações entre fatores com ANOVA e `emmeans`\n-   Usar transformações, identificar efeitos principais e interações\n-   Gerar gráficos de interação e comparação de médias\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(DHARMa)\nlibrary(car)\nlibrary(multcomp)\nlibrary(emmeans)\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(agricolae)\nlibrary(epifitter)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\ninsetos <- InsectSprays\nm3 <- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(m3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Avaliação de resíduos do modelo anterior (paramétrico)\n\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sqrt(count) ~ spray, data = insetos)\n\nCoefficients:\n(Intercept)       sprayB       sprayC       sprayD       sprayE       sprayF  \n     3.7607       0.1160      -2.5158      -1.5963      -1.9512       0.2579  \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m3))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# GLM com distribuição Poisson (modelo para contagens)\n\nm4 <- glm(count ~ spray, data = insetos, family = poisson)\nanova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    \nNULL                     71     409.04              \nspray  5   310.71        66      98.33 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nAnova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(>Chisq)    \nspray   310.71  5  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Médias ajustadas e comparação\nmedias_m4 <- emmeans(m4, ~ spray, type = \"response\")\ncld(medias_m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.100 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.180 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Interações entre tratamento e dose - antifúngicos\n\nantifungicos <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=2023059672#gid=2023059672\")\n\n# Gráfico de interação\ninteraction.plot(antifungicos$treat, antifungicos$dose, antifungicos$severity)\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Visualizações individuais\np1 <- antifungicos |> \n  ggplot(aes(factor(dose), severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\np2 <- antifungicos |> \n  ggplot(aes(treat, severity * 100)) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1)\n\n# Combinação dos gráficos\np1 + p2\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação completo e diagnóstico\n\nm_anti <- lm(severity ~ treat * dose, data = antifungicos)\nanova(m_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m_anti))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Médias ajustadas por dose dentro de cada tratamento\nmedia_anti <- emmeans(m_anti, ~ dose | treat)\nmedia_anti\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.2921 0.0273 16  0.23420   0.3500\n  2.0 0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.0210 0.0273 16 -0.03690   0.0789\n  2.0 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(media_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Coeficiente de variação\ncv.model(m_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 63.7165\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Análise de oídio com AUDPC (épifoca)\n\noidio <- PowderyMildew\n\n# Visualização inicial com filtragem\noidio |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |>  \n  ggplot(aes(time, sev)) +\n  geom_point() +\n  facet_grid(moisture ~ irrigation_type)\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Cálculo do AUDPC e visualização por irrigação\n\noidio2 <- oidio |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\"))\n\noidio3 <- oidio2 |> \n  group_by(irrigation_type, moisture, block) |> \n  summarize(AUDPC = AUDPC(time, sev), .groups = \"drop\")\n\noidio3 |> \n  ggplot(aes(irrigation_type, AUDPC, color = moisture)) +\n  geom_point(size = 2) +\n  scale_y_continuous(limits = c(0, 20))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Modelo de interação: AUDPC ~ irrigação * umidade\n\nmodel_oidio <- lm(AUDPC ~ irrigation_type * moisture, data = oidio3)\nanova(model_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: AUDPC\n                         Df  Sum Sq Mean Sq F value    Pr(>F)    \nirrigation_type           2 134.341  67.170 451.721 5.073e-12 ***\nmoisture                  1   6.680   6.680  44.924 2.188e-05 ***\nirrigation_type:moisture  2   5.104   2.552  17.162 0.0003022 ***\nResiduals                12   1.784   0.149                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(model_oidio))\n```\n\n::: {.cell-output-display}\n![](aula4_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Médias ajustadas\nmedias_oidio <- emmeans(model_oidio, ~ irrigation_type | moisture)\nmedias_oidio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS                8.52 0.223 12     8.04     9.01\n MS above canopy   3.99 0.223 12     3.51     4.48\n Overhead          3.68 0.223 12     3.20     4.17\n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS               11.18 0.223 12    10.70    11.67\n MS above canopy   4.86 0.223 12     4.37     5.34\n Overhead          3.81 0.223 12     3.33     4.30\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.68 0.223 12     3.20     4.17  1    \n MS above canopy   3.99 0.223 12     3.51     4.48  1    \n MS                8.52 0.223 12     8.04     9.01   2   \n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.81 0.223 12     3.33     4.30  1    \n MS above canopy   4.86 0.223 12     4.37     5.34   2   \n MS               11.18 0.223 12    10.70    11.67    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Coeficiente de variação do modelo\ncv.model(model_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.418205\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}