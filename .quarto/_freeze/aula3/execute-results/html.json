{
  "hash": "a12eb26c6c7b74593ee785477f35a064",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 3 - Testes Estatísticos e Visualizações\"\nauthor: \"Pedro Thiagos Santos Nogueira\"\ndate: \"2025-04-16\"\nformat: html\neditor: visual\n---\n\n\n\n\n## Aula 3 – 16/04/2025\n\n### Disciplina: FIP606 – Análise e Visualização de Dados em Fitopatologia\n\n**Professor:** Emerson Del Ponte\n\n#### ✦ Objetivos da aula:\n\n-   Aplicar testes estatísticos (t de Student, ANOVA, Kruskal-Wallis, Shapiro-Wilk, Levene)\n-   Comparar dois grupos com `t.test()`\n-   Verificar pressupostos de normalidade e homocedasticidade\n-   Usar modelos lineares (lm), ANOVA e transformações\n-   Visualizar resultados com `ggplot2` e `ggpubr`\n-   Trabalhar com dados paramétricos e não-paramétricos\n-   Realizar testes de médias (emmeans, multcomp)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)        # Importa dados diretamente de planilhas Google Sheets\nlibrary(tidyverse)     # Conjunto de pacotes para manipulação de dados (dplyr, tidyr, etc.)\nlibrary(ggplot2)       # Criação de gráficos baseados no Grammar of Graphics\nlibrary(ggpubr)        # Extensões do ggplot2 com suporte a estatísticas e temas prontos\nlibrary(report)        # Gera interpretações automáticas e legíveis de testes estatísticos\nlibrary(rstatix)       # Funções simplificadas para testes estatísticos (t, ANOVA, Levene, etc.)\nlibrary(emmeans)       # Estima e compara médias ajustadas de modelos (muito útil pós-ANOVA)\nlibrary(multcomp)      # Permite contrastes múltiplos e testes de comparações múltiplas\nlibrary(multcompView)  # Gera letras compactas para visualização de grupos estatisticamente distintos\nlibrary(car)           # Contém o teste de Levene (leveneTest) e outras funções para modelos lineares\nlibrary(agricolae)     # Para o teste de Kruskal com agrupamento de médias\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Importando dados para comparação entre tratamentos\n\ndata_Mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\n# Visualização inicial: dispersão dos valores por tratamento\ndata_Mg |>  \n  ggplot(aes(trat, comp)) +\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Preparação dos dados para teste t de Student (dois grupos)\n\n# Transforma o data frame para formato wide: colunas separadas para cada grupo\ndata_Mg2 <- data_Mg |> \n  pivot_wider(names_from = trat, values_from = comp) |> \n  select(-rep)  # Remove coluna de repetições (caso exista)\n\n# Teste t para dois grupos (não pareado)\nattach(data_Mg2)  # Acessar colunas diretamente (Mg2 e control)\nt_results <- t.test(Mg2, control, var.equal = FALSE)\n\n# Relatório interpretável do teste\ntest_report <- report(t_results)\ntest_report\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between Mg2 and control\n(mean of x = 10.52, mean of y = 15.68) suggests that the effect is negative,\nstatistically significant, and large (difference = -5.16, 95% CI [-6.49,\n-3.83], t(17.35) = -8.15, p < .001; Cohen's d = -3.65, 95% CI [-5.12, -2.14])\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Teste t usando fórmula e comparação com ggplot\n\ntest <- t_test(comp ~ trat, data = data_Mg)\n\n# Gráfico com comparação dos grupos e valor de p\np <- ggboxplot(\n  data_Mg, x = \"trat\", y = \"comp\",\n  color = \"trat\", palette = \"jco\")\n\n# Adiciona valor de p ao gráfico\np + \n  stat_pvalue_manual(test, label = \"p\", y.position = 18) +\n  ylim(0, 20) +\n  labs(x = \"Tratamento\", y = \"Comprimento (mm)\")\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"plot2.png\", bg = \"white\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Testes de pressupostos estatísticos\n\n# Normalidade (Shapiro-Wilk)\nshapiro.test(data_Mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  data_Mg2$Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(data_Mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  data_Mg2$control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\n# Histogramas para avaliar distribuição visual\nhist(data_Mg2$Mg2)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(data_Mg2$control)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Teste de homogeneidade de variâncias (F-test)\nvar.test(data_Mg2$Mg2, data_Mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  data_Mg2$Mg2 and data_Mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Análise de dados emparelhados – estudo de acurácia\n\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\n\n# Teste t para dados pareados entre dois métodos de avaliação\nt_test(acuracia ~ assessment, data = escala, paired = TRUE, var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* <chr>    <chr>  <chr>   <int> <int>     <dbl> <dbl>   <dbl>\n1 acuracia Aided1 Unaided    10    10      4.42     9 0.00167\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualização com boxplot\nescala |> \n  ggplot(aes(assessment, acuracia)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Comparação direta entre duas categorias específicas\n\nunaided <- escala |> \n  filter(assessment == \"Unaided\") |> \n  select(acuracia) |> \n  pull()\n\naided <- escala |> \n  filter(assessment == \"Aided1\") |> \n  select(acuracia) |> \n  pull()\n\n# Teste F para variâncias\nvar.test(unaided, aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  unaided and aided\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Verificação de normalidade\nhist(aided)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(aided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  aided\nW = 0.92852, p-value = 0.4335\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste t pareado entre os dois grupos\nt.test(unaided, aided, paired = TRUE, var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  unaided and aided\nt = -4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -0.3552353 -0.1147647\nsample estimates:\nmean difference \n         -0.235 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste não-paramétrico de Wilcoxon (caso normalidade não seja atendida)\nwilcox.test(unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  unaided\nV = 55, p-value = 0.005857\nalternative hypothesis: true location is not equal to 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Dados de crescimento micelial por espécie (ANOVA)\n\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualização: dispersão por espécie\nmicelial |> \n  ggplot(aes(especie, tcm)) +\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Modelos para análise de variância\nanova1 <- aov(tcm ~ especie, data = micelial)      # ANOVA tradicional\nanova2 <- lm(tcm ~ especie, data = micelial)       # Modelo linear equivalente\n\n# Sumário dos testes\nanova(anova1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(anova2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Diagnóstico de resíduos\nhist(residuals(anova1))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(anova1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n\n```{.r .cell-code}\nlevene_test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  <int> <int>     <dbl> <dbl>\n1     4    25      1.76 0.169\n```\n\n\n:::\n\n```{.r .cell-code}\n# Testes de médias\nm <- emmeans(anova2, ~ especie)\nm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(m)  # Compact letter display\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Exemplo clássico: InsectSprays\n\ninsetos <- InsectSprays\n\n# Visualização\ninsetos |> \n  ggplot(aes(spray, count)) +\n  geom_jitter(width = 0.1) +\n  geom_boxplot(outlier.color = NA)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Ajuste do modelo e diagnóstico\nm2 <- lm(count ~ spray, data = insetos)\nshapiro.test(residuals(m2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m2)\nW = 0.96006, p-value = 0.02226\n```\n\n\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nlevene_test(count ~ spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n    df1   df2 statistic       p\n  <int> <int>     <dbl>   <dbl>\n1     5    66      3.82 0.00422\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(residuals(m2))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(m2))\nqqline(residuals(m2))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Alternativa 1 – Transformação da resposta (sqrt)\nm3 <- lm(sqrt(count) ~ spray, data = insetos)\nhist(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(m3))\nqqline(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-5.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(residuals(m3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(m3)\nW = 0.98721, p-value = 0.6814\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: sqrt(count)\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nm33 <- emmeans(m3, ~ spray, type = \"response\")\ncld(m33)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n spray response    SE df lower.CL upper.CL .group\n C         1.55 0.452 66    0.779     2.58  1    \n E         3.27 0.656 66    2.095     4.72  12   \n D         4.68 0.785 66    3.248     6.38   2   \n A        14.14 1.360 66   11.550    17.00    3  \n B        15.03 1.410 66   12.352    17.97    3  \n F        16.15 1.460 66   13.370    19.19    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(m33)\n```\n\n::: {.cell-output-display}\n![](aula3_files/figure-html/unnamed-chunk-9-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# Alternativa 2 – Teste não-paramétrico de Kruskal-Wallis\nkruskal.test(count ~ spray, data = insetos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n\n\n:::\n\n```{.r .cell-code}\nkruskal(insetos$count, insetos$spray, group = TRUE, console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: insetos$count ~ insetos$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\ninsetos$spray,  means of the ranks\n\n  insetos.count  r\nA      52.16667 12\nB      54.83333 12\nC      11.45833 12\nD      25.58333 12\nE      19.33333 12\nF      55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  insetos$count groups\nF      55.62500      a\nB      54.83333      a\nA      52.16667      a\nD      25.58333      b\nE      19.33333     bc\nC      11.45833      c\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}