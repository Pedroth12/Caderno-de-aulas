{
  "hash": "52cfb54fd4cec5fad294783c3e3f0f5a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 5 - Modelos Mistos, Transformações e Correlações\"\nauthor: \"Pedro Thiagos Santos Nogueira\"\ndate: \"2025-04-30\"\nformat: html\neditor: visual\n---\n\n\n\n\n## Aula 5 – 30/04/2025\n\n### Disciplina: FIP606 – Análise e Visualização de Dados em Fitopatologia\n\n**Professor:** Emerson Del Ponte\n\n#### ✦ Objetivos da aula:\n\n-   Aplicar modelos lineares com blocos\n-   Interpretar modelos mistos com o pacote `lme4`\n-   Calcular médias ajustadas e fazer comparações múltiplas\n-   Avaliar resíduos simulados com `DHARMa`\n-   Explorar relações entre variáveis por meio de correlações e regressão\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Pacotes necessários\nlibrary(gsheet)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(report)\nlibrary(rstatix)\nlibrary(agricolae)\nlibrary(epifitter)\nlibrary(car)\nlibrary(multcomp)\nlibrary(DHARMa)\nlibrary(multcompView)\nlibrary(emmeans)\nlibrary(patchwork)\nlibrary(lme4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Análise de experimento em campo (tratamentos x produtividade)\n\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Visualização inicial\ncampo |> \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.1) +\n  stat_summary(fun.data = 'mean_cl_boot', colour = 'red', width = 0.3)\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Conversão de variáveis para fator\ncampo$TRAR <- factor(campo$TRAT)\ncampo$BLOCO <- factor(campo$BLOCO)\n\n# Modelo com transformação logarítmica (para FER)\nm_campo <- lm(log(FER) ~ BLOCO + TRAT, data = campo)\nanova(m_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nBLOCO      3 0.2064  0.0688  0.2825   0.8375    \nTRAT       1 5.7509  5.7509 23.6174 4.44e-05 ***\nResiduals 27 6.5745  0.2435                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m_campo))\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Médias ajustadas\nmeans_campo <- emmeans(m_campo, ~ TRAT, type = \"response\")\nmeans_campo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT response    SE df lower.CL upper.CL\n  4.5     4.44 0.387 27     3.71     5.31\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n\n\n:::\n\n```{.r .cell-code}\ncv.model(m_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 33.10603\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(means_campo)\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\ncld(means_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT response    SE df lower.CL upper.CL .group\n  4.5     4.44 0.387 27     3.71     5.31  1    \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nNote: contrasts are still on the log scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(means_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       4.5\n4.5 [4.44]\n\nRow and column labels: TRAT\nUpper triangle: P values \nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Dados de milho híbrido\n\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualização por método e híbrido\nmilho |> \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1) +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Criação de bloco aninhado (modelo misto)\nmilho$hybrid_block <- interaction(milho$hybrid, milho$block)\n\n# Modelo misto para índice\nm_milho <- lmer(index ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(m_milho)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m_milho))\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmedia_milho <- emmeans(m_milho, ~ method | hybrid)\ncld(media_milho, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     25.0 3.57 24.9     17.7     32.3  a    \n pin      25.3 3.57 24.9     17.9     32.6  a    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      24.6 3.57 24.9     17.3     31.9  a    \n silk     26.2 3.57 24.9     18.9     33.6  a    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      20.6 3.57 24.9     13.2     27.9  a    \n silk     21.5 3.57 24.9     14.2     28.8  a    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.5 3.57 24.9     19.2     33.8  a    \n pin      38.1 3.57 24.9     30.8     45.4   b   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.6 3.57 24.9     19.3     34.0  a    \n pin      32.5 3.57 24.9     25.2     39.8  a    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     19.2 3.57 24.9     11.8     26.5  a    \n pin      19.4 3.57 24.9     12.1     26.8  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Modelo misto para produtividade\nyield_model <- lmer(yield ~ hybrid * method + (1 | block:hybrid_block), data = milho)\ncar::Anova(yield_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yield\n                Chisq Df Pr(>Chisq)    \nhybrid        22.5966  5  0.0004031 ***\nmethod         0.1052  1  0.7456932    \nhybrid:method 25.9302  5  9.206e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(yield_model))\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nmedia_milho2 <- emmeans(yield_model, ~ method | hybrid)\ncld(media_milho2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nhybrid = 30F53 HX:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9988 798 21.1     8328    11647  a    \n pin     11208 798 21.1     9548    12867   b   \n\nhybrid = 30F53 YH:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9211 798 21.1     7552    10870  a    \n pin      9408 798 21.1     7748    11067  a    \n\nhybrid = 30K64:\n method emmean  SE   df lower.CL upper.CL .group\n silk    10361 798 21.1     8702    12020  a    \n pin     11675 798 21.1    10016    13334   b   \n\nhybrid = 30S31H:\n method emmean  SE   df lower.CL upper.CL .group\n pin      8118 798 21.1     6459     9777  a    \n silk     9185 798 21.1     7526    10844   b   \n\nhybrid = 30S31YH:\n method emmean  SE   df lower.CL upper.CL .group\n pin      7836 798 21.1     6177     9495  a    \n silk     8277 798 21.1     6618     9936  a    \n\nhybrid = BG7049H:\n method emmean  SE   df lower.CL upper.CL .group\n pin     11970 798 21.1    10311    13629  a    \n silk    12833 798 21.1    11174    14492  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ───────────────────────────────────────────────────────────────\n# Correlação entre variáveis de desempenho (índice vs produtividade)\n\nmilho |> \n  ggplot(aes(index, yield)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor1 <- cor(milho$index, milho$yield)\ncor1 * cor1 * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.323713\n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(milho$index, milho$yield)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Correlação em dados de campo\ncor(campo$FER, campo$PROD)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.6258321\n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(campo$FER, campo$DFC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  campo$FER and campo$DFC\nt = 14.049, df = 30, p-value = 9.864e-15\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8635525 0.9664228\nsample estimates:\n      cor \n0.9316978 \n```\n\n\n:::\n\n```{.r .cell-code}\ncampo |> \n  ggplot(aes(FER, DFC)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](aula5_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}